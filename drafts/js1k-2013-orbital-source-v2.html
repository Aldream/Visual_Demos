<!doctype html>
<html>
	<head>
		<title>JS1k, 1k demo submission [ID]</title>
		<meta charset="utf-8" />
	</head>
	<body>
		<canvas id="c"></canvas>
		<script>
			var b = document.body;
			var c = document.getElementsByTagName('canvas')[0];
			var a = c.getContext('2d');
			document.body.clientWidth; // fix bug in webkit: http://qfox.nl/weblog/218
		</script>
		<script>
			// Math.round(a) -> a+.5|0
			// Be warry, Google Closure can strip the useless parameters in the function signatures, while they can be useful during the minification by jscrush.
			
			s=[],f=[],x='px ',r='rgb(',v=document,y=101,l=0,t=0,p='</i>',g=b.scrollWidth/2,u=b.scrollHeight/2,k=Math.cos,i=Math.sin,j=Math.tan;
			a='<i style="position:fixed">';
			a=a+b.innerHTML.split('').join(p+a)+p;
			c=v.createElement('p');
			c.innerHTML=a;
			v.onclick = function(d,h,z,w){f.push(y)};
			v.onmousemove = function(d,h,z,w){l=d.clientX/y;t=d.clientY/y;};
			c=b.appendChild(c).children;
			for(a=c.length;a--;s[a]=c[a].style); // Trying to fix the bad performances with Firefox
			setInterval(function(d,h,z,w){
				p=0;
				a+=.01;
				for(z in f){
					h=Math.abs(50-f[z]--)/49;
					p+=h>1?0:1-h*(3-2*h)*h;
					f[z]||f.shift(); // clean, but optional
				}
				for(w=s.length;w--;
					c=s[w],
					d=(w/y+1)*y/(2-p),
					c.left=g*(1-i(d*.0017+l)/2)+d*k(d*a/y+w/d*10)*k(d*a*.0031)*(1-j(w*p*.017))+x,
					c.top=u*(1-k(d*a/y+t)/2)+d*i(d*a/y+w/d*10)*i(d*a*.0031)*(1-j(w*p*.017))+x,
					c.textShadow='0 0 '+(c.fontSize=8+w/49+k(d*a/y)*(w/y)*(1-j(w*p*.083))/5+x)+(c.color=r+[y+i(w*a/y)*y+.5|0,y+k(a*.017)*y*(1-p)+.5|0,y+k(d*a/y)*y*(1-p)+.5|0]+')')
				);
				b.style.background=r+[y*i(p*a/t)+.5|0,y*i(p*a/l)+.5|0,9]+')';
			},17);
		</script>
	</body>
</html>
